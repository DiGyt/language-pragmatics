{"remainingRequest":"/home/dirk/WebstormProjects/chat_experiment/language-pragmatics/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/dirk/WebstormProjects/chat_experiment/language-pragmatics/src/components/AltChat.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/home/dirk/WebstormProjects/chat_experiment/language-pragmatics/src/components/AltChat.vue","mtime":1614864124597},{"path":"/home/dirk/WebstormProjects/chat_experiment/language-pragmatics/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/dirk/WebstormProjects/chat_experiment/language-pragmatics/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/dirk/WebstormProjects/chat_experiment/language-pragmatics/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/dirk/WebstormProjects/chat_experiment/language-pragmatics/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/dirk/WebstormProjects/chat_experiment/language-pragmatics/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouY2hhdCB7CiAgd2lkdGg6IDQ1MHB4Owp9CgouY2hhdC1ib3ggewogIG92ZXJmbG93OiBhdXRvOwogIGhlaWdodDogNDAwcHg7Cn0KCi5tZXNzYWdlIHsKICB3aWR0aDogNTUlOwogIGZsb2F0OiBsZWZ0OwogIHRleHQtYWxpZ246IGxlZnQ7CiAgYmFja2dyb3VuZDogIzUxODdiYTdhOwogIGJvcmRlci1yYWRpdXM6IDRweDsKICBwYWRkaW5nOiA0cHg7CiAgbWFyZ2luOiA1cHggMDsKfQoKLm1lc3NhZ2UubWUgewogIGZsb2F0OiByaWdodDsKICBiYWNrZ3JvdW5kOiAjNzBiYTUxN2E7Cn0KCi5jaGF0LWlucHV0IHsKICBkaXNwbGF5OiBmbGV4Owp9CgouY2hhdC1pbnB1dCB0ZXh0YXJlYSB7CiAgZmxleC1ncm93OiAxOwogIGhlaWdodDogMzJweDsKfQoKLmNoYXQtaW5wdXQgYnV0dG9uIHsKICBtYXJnaW46IDA7Cn0KCi5ub3RpY2UtYm94OmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjogI2ZmOWMwMDsgfQoubm90aWNlLWJveCB7CiAgYmFja2dyb3VuZC1jb2xvcjogI2JkOTc1YTsKICBib3JkZXI6MXB4IHNvbGlkICNlZGE5M2I7CiAgZm9udC13ZWlnaHQ6Ym9sZDsKICB0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7CiAgbGV0dGVyLXNwYWNpbmc6IDFweDsKfQoK"},{"version":3,"sources":["AltChat.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2GA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AltChat.vue","sourceRoot":"src/components","sourcesContent":["\n<template>\n  <div class=\"AltChat\">\n    <div id=\"chatbox_1\" ref=\"box\" class=\"chat-box\">\n      <p id=\"prg\"\n          v-for=\"(message, i) in messages\"\n          :key=\"i\"\n          :class=\"{\n          message: true,\n          me: message.participantId === $magpie.socket.participantId\n        }\"\n          v-text=\"message.message\"\n      ></p>\n    </div>\n    <div class=\"notice-box\">{{active}}</div>\n    <div class=\"chat-input\">\n      <textarea\n          ref=\"text\"\n          cols=\"50\"\n          placeholder=\"Type your message to the other participant here.\"\n          @keydown.enter=\"send\"\n      ></textarea>\n      <button @click.stop=\"send()\" @v>\n        Send\n      </button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Vue from 'vue';\nconst EVENT_CHAT_MESSAGE = 'chat_message';\nconst EVENT_CHAT_ACTIVE = 'inactive';\n\nexport default {\n  name: 'AltChat',\n  data() {\n    return {\n      messages: [],\n      statusMonitor: {},\n      active: \"Your chat partner has not yet entered the chat.\",\n      update: null\n    };\n  },\n  socket: {\n    [EVENT_CHAT_MESSAGE](payload) {\n      this.messages.push(payload);\n      Vue.nextTick(() => {\n        this.$refs.box.scrollTop = this.$refs.box.scrollHeight;\n      });\n      this.$emit('update:messages', this.messages);\n    },\n    [EVENT_CHAT_ACTIVE](payload) {\n      this.statusMonitor[payload.participantId] = payload;\n      this.$emit('update:statusMonitor', this.statusMonitor);\n    }\n  },\n  EVENT_CHAT_MESSAGE,\n  EVENT_CHAT_ACTIVE,\n  created () {\n    this.monitorActivity()\n  },\n  deactivated() {\n    this.$magpie.addResult({ question: \"Chat msgs\", answer: this.messages});\n    clearInterval(this.update);\n  },\n  methods: {\n    send() {\n      const message = this.$refs.text.value;\n      if (!message) {\n        return;\n      }\n      this.$magpie.socket.broadcast(EVENT_CHAT_MESSAGE, {\n        message,\n        participantId: this.$magpie.socket.participantId\n      });\n      this.$refs.text.value = '';\n      this.$refs.text.focus();\n    },\n    monitorActivity(){\n      this.update = setInterval(() => {\n        // set yourself active\n        this.$magpie.socket.broadcast(EVENT_CHAT_ACTIVE, {\n          status: \"active\",\n          participantId: this.$magpie.socket.participantId,\n          lastUpdated: new Date()\n        });\n        // check if partner is active\n        for (let [participantID, status] of Object.entries(this.statusMonitor)) {\n          console.log(this.statusMonitor)\n          if (participantID != this.$magpie.socket.participantId) {\n            if (status.status === \"active\") {\n              if ((new Date() - new Date(status.lastUpdated)) > 10 * 1000) {\n                this.active = \"Your chat partner has left the chat. Please click `leave chat` to finish the experiment.\";\n              } else {\n                this.active = \"Your chat partner is active\";\n              }\n            }\n          }\n          console.log(this.active);\n        }\n      }, 3000)\n    }\n  }\n};\n</script>\n<style>\n.chat {\n  width: 450px;\n}\n\n.chat-box {\n  overflow: auto;\n  height: 400px;\n}\n\n.message {\n  width: 55%;\n  float: left;\n  text-align: left;\n  background: #5187ba7a;\n  border-radius: 4px;\n  padding: 4px;\n  margin: 5px 0;\n}\n\n.message.me {\n  float: right;\n  background: #70ba517a;\n}\n\n.chat-input {\n  display: flex;\n}\n\n.chat-input textarea {\n  flex-grow: 1;\n  height: 32px;\n}\n\n.chat-input button {\n  margin: 0;\n}\n\n.notice-box:hover { background-color: #ff9c00; }\n.notice-box {\n  background-color: #bd975a;\n  border:1px solid #eda93b;\n  font-weight:bold;\n  text-transform:uppercase;\n  letter-spacing: 1px;\n}\n\n</style>\n"]}]}